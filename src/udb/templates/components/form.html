{% for id, field in form._fields.items() %}
  {% if field.widget['input_type'] == 'hidden' %}
    {{ field() }}
  {% else %}
    {% set width = {'1/2': 'col-6','1/3': 'col-4','1/4': 'col-3'}.get((field.render_kw or {}).get('width', None), '') %}
    {% set extra_label_class = field.errors and ' is-invalid' or '' %}
    {% if field.widget.__class__.__name__ == 'SubmitInput' %}
      <div class="mb-3">
        {{ field(id=False) }}
        {% if field.description %}<div class="form-text">{{ field.description }}</div>{% endif %}
        {% for error in field.errors %}<div class="invalid-feedback">{{ error }}</div>{% endfor %}
      </div>
    {% elif field.widget.__class__.__name__ == 'CheckboxInput' %}
      <div class="form-check">
        {{ field(id=False) }}
        {{ field.label(class="form-check-label" + extra_label_class) }}
        {% if field.description %}<div class="form-text small test-secondary">{{ field.description }}</div>{% endif %}
        {% for error in field.errors %}<div class="invalid-feedback">{{ error }}</div>{% endfor %}
      </div>
    {% elif floating and field.widget.__class__.__name__ != 'SelectMultiCheckbox' %}
      <div class="form-floating mb-2">
        {{ field(id=False) }}
        {{ field.label(class='form-label' + extra_label_class) }}
        {% if field.description %}<div class="form-text">{{ field.description }}</div>{% endif %}
        {% for error in field.errors %}<div class="invalid-feedback">{{ error }}</div>{% endfor %}
      </div>
    {% else %}
      <div class="mb-3 {{width}}">
        {{ field.label(class='form-label' + extra_label_class) }}
        {{ field(id=False) }}
        {% if field.description %}<div class="form-text">{{ field.description }}</div>{% endif %}
        {% for error in field.errors %}<div class="invalid-feedback">{{ error }}</div>{% endfor %}
      </div>
    {% endif %}
  {% endif %}
{% endfor %}
