{% macro list_messages(comments=True, changes=True) -%}
<div class="list-group list-group-flush">
    {% for message in obj.get_messages()|sort(attribute="date",reverse=True) %}
    {% if (changes and message.changes) or (comments and not message.changes) %}
    <a href="#" class="list-group-item list-group-item-action" aria-current="true">
        <small>{%trans%}By {%endtrans%} {{ macro.user(message.author) }} â€¢ {{ message.date }}
            ({{message.date|lastupdated}})</small>
        {{ message }}
    </a>
    {% endif %}
    {% endfor %}
</div>
{%- endmacro %}

{% if has_messages %}
<div class="card">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs" role="tablist">
            <li class="nav-item" role="presentation">
                <a class="nav-link active" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments"
                    type="button" role="tab" aria-controls="home" aria-selected="true">{%trans%}Comments{%endtrans%}</a>
            </li>
            <li class="nav-item" role="presentation">
                <a class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#history" type="button"
                    role="tab" aria-controls="history" aria-selected="true">{%trans%}History{%endtrans%}</a>
            </li>
        </ul>
    </div>
    <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="comments" role="tabpanel" aria-labelledby="comments-tab">
            <!--Form -->
            <div class="card-body">
                <div class="comment-form">
                    <form method="post" action="{{url_for(obj, 'post')}}">
                        <div class="mb-3 form-floating">
                            <textarea name="body" class="form-control" placeholder="Leave a comment here"
                                id="floatingTextarea2" style="height: 80px"></textarea>
                            <label for="floatingTextarea2">{%trans%}Leave a comments{%endtrans%}</label>
                        </div>
                        <button type="submit" class="btn btn-secondary">{%trans%}Add comment{%endtrans%}</button>
                    </form>
                </div>
            </div>
            {{ list_messages(True, False) }}
        </div>
        <div class="tab-pane fade" id="history" role="tabpanel" aria-labelledby="history-tab">
            {{ list_messages(False, True) }}
        </div>
    </div>
</div>
{% endif %}